#Simulating 1000 octane molecules

# ------------------------------- Initialization Section --------------------
atom_style full
units real
bond_style harmonic
angle_style harmonic
dihedral_style opls
improper_style harmonic
pair_style lj/cut/coul/long 10.0 10.0
pair_modify mix geometric
special_bonds lj/coul 0.0 0.0 0.5
kspace_style pppm 0.0001

# ------------------------------- Atom Definition Section -------------------

# Reads a crystalline array array of methane (10x10x10)

read_data       "system.data"

# ------------------------------- Settings Section --------------------------

  pair_coeff 1 1 0.066 3.5
  pair_coeff 2 2 0.066 3.5
  pair_coeff 3 3 0.03 2.5
  pair_coeff 4 4 0.026290630975 2.5
  bond_coeff 1 268.0 1.529
  bond_coeff 2 340.0 1.09
  angle_coeff 1 58.35 112.7
  angle_coeff 2 33.0 107.8
  angle_coeff 3 37.5 110.7
  dihedral_coeff 1 0.0 0.0 0.3 0.0
  dihedral_coeff 2 0.0 0.0 0.3 0.0
  dihedral_coeff 3 0.6446926386 -0.2143420172 0.1782194073 0.0
  

# Charges 
  set type 1 charge -0.222
  set type 2 charge -0.148
  set type 3 charge 0.074
  set type 4 charge 0.074

# ------------------------------- Run Equilibration -------------------------------


# -- minimization protocol --

# Note: The minimization step is not necessary in this example.  However
#       in general, it's always a good idea to minimize the system beforehand.
#       (The "fShakeSPCE" fix was defined in system.in.settings. 
#        It is incompatible with "minimize", so we disable it first.)
#unfix         fShakeSPCE
thermo        500
minimize 1.0e-4 1.0e-6 100000 400000


# Optional: write the coordinates after minimization
write_data   system_after_min.data


# ------------------------------- Run NVT Section -------------------------------
# -- simulation protocol --

neighbor 0.5 bin
neigh_modify delay 0 every 1 check yes

timestep        1.0

dump            nvt_traj all custom 10000 traj_nvt.lammpstrj id mol type x y z ix iy iz
fix             fxnvt all nvt temp 300.0 300.0 100.0 tchain 1

run             100000

write_data   system_after_nvt.data
