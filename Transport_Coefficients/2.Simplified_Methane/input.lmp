#Simulating 1000 methane molecules

# ------------------------------- Initialization Section --------------------
atom_style full
units real
bond_style harmonic
angle_style harmonic
pair_style lj/cut/coul/long 10.0 10.0
pair_modify mix geometric
special_bonds lj/coul 0.0 0.0 0.5
kspace_style pppm 0.0001

# ------------------------------- Atom Definition Section -------------------

# Reads a crystalline array array of methane (10x10x10)

read_data       "system.data"

# ------------------------------- Settings Section --------------------------

pair_coeff 1 1 0.066 3.5
pair_coeff 2 2 0.03 2.5
bond_coeff 1 340.0 1.09
angle_coeff 1 33.0 107.8
set type 1 charge -0.24
set type 2 charge 0.06


# ------------------------------- Run NPT Section -------------------------------


# -- minimization protocol --

# Note: The minimization step is not necessary in this example.  However
#       in general, it's always a good idea to minimize the system beforehand.
#       (The "fShakeSPCE" fix was defined in system.in.settings. 
#        It is incompatible with "minimize", so we disable it first.)
#unfix         fShakeSPCE
thermo        500
minimize 1.0e-4 1.0e-6 100000 400000

# Now read "system.in.settings" in order to enable fShakeSPCE again:
#include       system.in.settings

# Optional: write the coordinates after minimization
write_data   system_after_min.data


# -- simulation protocol --


timestep        1.0
dump            npt_traj all custom 1000 traj_npt.lammpstrj id mol type x y z ix iy iz
fix             fxnpt all npt temp 300.0 300.0 100.0 iso 1.0 1.0 1000.0 drag 1.0

run             500000

write_data   system_after_npt.data

# ------------------------------- Run NVT Section -------------------------------
unfix 		fxnpt
undump 		npt_traj

dump            nvt_traj all custom 1000 traj_nvt.lammpstrj id mol type x y z ix iy iz
fix             fxnvt all nvt temp 300.0 300.0 500.0 tchain 1

run             50000

write_restart   system_after_nvt.data
