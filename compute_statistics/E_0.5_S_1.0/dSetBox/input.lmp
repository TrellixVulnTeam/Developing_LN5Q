# TIP4P water box benchmark
 
clear

#
# step interval for outputs
variable	myThermo equal 1000
variable	myRestart equal 100000
variable        myImage equal 1000
variable        myDump equal 100000
variable        myStepsEach equal 10000
variable        myLoop loop 20

units		lj	
atom_style	full
boundary p p p

read_data	mt.data
#read_restart	init.0

##########################################################
#setting interaction parameter
include ../in.interaction
##########################################################

# set parameters of Varlet neighbor lis
neighbor        0.5 bin
neigh_modify	every 1 delay 10 check yes

# minimize potential of system
#min_style hftn
minimize 0.0 0.0 100 100

##########################################################
#setting geometry
include ../in.geom
##########################################################

# set velocities of particles
velocity	gSol create 1.0 123456 dist gaussian

# set time step
reset_timestep 0
timestep	0.005
run_style	verlet

# set time steps of recording restart file
restart		${myRestart} ./particle/restart.*


##############################################################
# output imagefiles
#dump mydumpImage all image ${myImage} ./image/*.jpg type type  zoom 1.2 view 60 60
#dump_modify mydumpImage adiam 1 0.2
#dump_modify mydumpImage adiam 2 0.2

##############################################################
# set display format for thermodynamic quantities
thermo	        ${myThermo}
#thermo_style	multi 
thermo_modify	format float %25.15f lost warn

##########################################################
#setting computation
include ../in.computations
##########################################################

fix pin all momentum 1 linear 1 0 0
#fix rig gPoly rigid single
variable P0 equal 1e0
#fix             3 all nvt temp 1.0 1.0 0.2
fix             3 all npt temp 1.0 1.0 0.2 y ${P0} ${P0} 5.0
fix_modify      3 temp tempsol

#######################################################
# set output
thermo_style custom step c_tempcal lx ly lz c_comPoly[3]  
fix data all ave/time 1 1000 1000 v_lxbox v_lybox v_lzbox c_comPoly[3] file "./therm.dat"
dump da all atom ${myDump} dump.atom

#######################################################
label loop

run		${myStepsEach}

#unfix rig
#unfix 3
variable zDis equal -(c_comPoly[3]-v_lhalf)
displace_atoms all move 0 0 v_zDis units box
#fix rig gPoly rigid single
#fix             3 all npt temp 1.0 1.0 0.2 y ${P0} ${P0} 5.0
#run		${mySteps}

next myLoop
jump SELF loop


#write_data conf.data nocoeff

clear
